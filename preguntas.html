<!DOCTYPE html>
<html>
<head>
    <meta name="tipo_contenido" content="text/html;" http-equiv="content-type" charset="utf-8">
    <title>Preguntas</title>
    <link rel='stylesheet' type='text/css' href='estilos/style.css' />
    <link rel='stylesheet'
          type='text/css'
          media='only screen and (min-width: 530px) and (min-device-width: 481px)'
          href='estilos/wide.css' />
    <link rel='stylesheet'
          type='text/css'
          media='only screen and (max-width: 480px)'
          href='estilos/smartphone.css' />
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
<div id='page-wrap'>
    <header class='main' id='h1'>
        <span class="right"><a href="registro">Registrarse</a></span>
        <span class="right"><a href="login">Login</a></span>
        <span class="right" style="display:none;"><a href="/logout">Logout</a></span>
        <h2>Quiz: el juego de las preguntas</h2>
    </header>
    <nav class='main' id='n1' role='navigation'><span><a href='./layout.html'>Inicio</a></span>
        <span><a href='./preguntas.html'>Preguntas</a></span>
            <span><a href='./creditos.html'>Creditos</a></span>
    </nav>
    <section class="main" id="s1">
        <div align="left">
            <form id="fpreguntas" name="fpreguntas" onsubmit="return validateForm()" enctype="multipart/form-data" action="InsertarPreguntaConImagen.php" method="POST">
                <label for="input_email">Email:*</label>
                <input id="input_email" name="email" type="text"><br>
                <label for="input_question">Enunciado de la pregunta:*</label>
                <input id="input_question" name="question" type="text"><br>
                <label for="input_correct_answer">Respuesta correcta:*</label>
                <input id="input_correct_answer" name="correctAnswer" type="text"><br>
                <label for="input_incorrect_answer_1">Respuesta incorrecta 1:*</label>
                <input id="input_incorrect_answer_1" name="incorrectAnswer1" type="text"><br>
                <label for="input_incorrect_answer_2">Respuesta incorrecta 2:*</label>
                <input id="input_incorrect_answer_2" name="incorrectAnswer2" type="text"><br>
                <label for="input_incorrect_answer_3">Respuesta incorrecta 3:*</label>
                <input id="input_incorrect_answer_3" name="incorrectAnswer3" type="text"><br>
                <label for="input_conplexity">Complejidad:*</label>
                <input id="input_conplexity" name="complexity"><br>
                <label for="input_topic">Tema:*</label>
                <input id="input_topic" name="topic" type="text"><br>
                <label for="input_image">Image:</label>
                <input id="input_image" name="image" type="file"><br>
                <button type="submit">Enviar solicitud</button>
            </form>

        </div>
    </section>
    <footer class='main' id='f1'>
        <p><a href="http://es.wikipedia.org/wiki/Quiz" target="_blank">Que es un Quiz?</a></p>
        <a href='https://github.com'>Link GITHUB</a>
    </footer>
</div>
<script>
    var emptyErrors = {
      input_email: 'Por favor, introduce tu dirección de correo electrónico.',
      input_question: 'Por favor, introduce la pregunta que deseas proponer.',
      input_correct_answer: 'Por favor, introduce la respuesta correcta.',
      input_incorrect_answer_1: 'Por favor, introduce la primera respuesta incorrecta.',
      input_incorrect_answer_2: 'Por favor, introduce la segunda respuesta incorrecta.',
      input_incorrect_answer_3: 'Por favor, introduce la tercera respuesta incorrecta.',
      input_conplexity: 'Por favor, introduce un nivel de complejidad.',
      input_topic: 'Por favor, introduce un tema.'
    };
    var emailRegexError = 'Por favor, introduce un email oficial de la UPV.\nEj: crivas004@ikasle.ehu.es';
    var complexityRangeError = 'Por favor, introduce una complejidad expresada en un número entero del 1 al 5';
    var questionLengthError = 'Por favor, introduce una pregunta de longitud no inferior a 10 caracteres.'

    function validateForm() {
        var isValid = true;

        // Check required inputs are not empty
        $("input").each(function () {
            if (!$(this).val() && $(this).attr("type") !== "file") {
                isValid = false;
                alert(emptyErrors[$(this).attr("id")]);
                return false;  // For exiting the 'each' loop
            }
        });
        if (!isValid) { return false; }  // Stop validating if is not a valid form

        // Check email matches regex pattern
        var emailPattern = /^[a-zA-Z]{3,}[0-9]{3}@ikasle.ehu.eu?s$/;
        if (!emailPattern.test($("#input_email").val())) {
            alert(emailRegexError);
            isValid = false;
            return false;
        }

        // Check if complexity is inside the valid range [1, 5]
        var complexity = Number($("#input_conplexity").val());
        if (!isNaN(complexity)) {
            if (!(complexity >= 1 && complexity <= 5)) {
                alert(complexityRangeError);
                isValid = false;
                return false;
            }
        } else {
            alert(complexityRangeError)
            isValid = false;
            return false;
        }

        // Check if question has a minimum of 10 characters length
        if ($("#input_question").val().length < 10) {
            isValid = false;
            alert(questionLengthError);
            return false;
        }

        return isValid;
    }
</script>
</body>
</html>
